# 📊 모멘텀 기반 단타 전략

## 🎯 **전략 개요**
시간외 거래 모멘텀을 활용한 **1일 완결형 단타 전략**
- **매수**: 필터링 조건 만족 + 시간외 거래 상승 확인 후 진입 (Day 1)
- **매도**: 다음날 정규장에서 시간 기반 청산 전략 적용 (Day 2)
- **보유기간**: 최대 1일 (익일 15:30까지 무조건 청산)

## 📅 **매매 플로우**

### **📈 Day 1 (매수일) - 종목 발굴 및 진입**

#### **15:30-15:35: 자동 필터링**
장 마감 즉시 전 종목 대상 필터링 실행
```
✅ 거래량이 평균 대비 2.0배 이상
✅ 후반부(14:00-15:30) 상승률 1% 이상
✅ 후반부 거래량 비중 15% 이상  
✅ 체결강도 110 이상
✅ 시장 대비 상대 수익률 1.5% 이상
✅ VWAP 대비 종가 102% 이상
```

#### **15:35: 동적 조건 조정** (필요시)
```
⚠️ 조건 미달 시 실시간 조정 옵션:
├── 후보 종목 0개 → 조건 완화 (1단계/2단계/3단계)
├── 후보 종목 20개+ → 조건 강화 
├── 프리셋 조정 또는 수동 조정 선택
└── 조정 후 즉시 재필터링 실행
```

#### **15:35-16:00: 포트폴리오 구성 결정**
```
📊 시스템 분석 리포트 제공
├── 필터링 통과 종목 리스트 (점수순 정렬)
├── 각 종목별 모멘텀 강도 분석
└── 시스템 권장 구성안 제시

👤 사용자 결정 사항
├── 매수할 종목 선택 (리스트 중에서)
├── 총 투자 금액 설정
├── 종목별 매수 금액 배분
└── 매수 비율 조정 (균등/가중/수동)
```

#### **16:00-17:40: 시간외 거래 30분 단위 모니터링**
```
16:00, 16:30, 17:00, 17:30 (총 4회 체크)
├── 선택된 종목들의 시간외 상승률 자동 확인
├── 2% 이상 상승시 설정된 금액으로 즉시 매수
├── 각 단계별 포지션 현황 리포트 자동 생성
└── 완전 자동화 실행 (추가 사용자 개입 없음)

⚙️ 시간외 동적 조정 (필요시)
├── 선택 종목 모두 조건 미달시 임계값 하향 조정
├── 백업 종목 리스트 활용 옵션
└── 즉시 재모니터링 실행
```

### **📉 Day 2 (매도일) - 시간 기반 청산**

#### **시간 기반 청산 전략**
| 시간대 | 익절 목표 | 손절 목표 | 청산 조건 |
|--------|-----------|-----------|-----------|
| 09:00~13:00 | +5% | -3% | 목표 달성시 즉시 청산 |
| 13:00~15:00 | +3% | -3% | 50% 달성시 부분 청산 |
| 15:00~15:20 | ±1.5% | ±1.5% | 범위 내 무조건 청산 |
| 15:20~15:30 | - | - | 손익 무관 강제 청산 |

## ⚙️ **핵심 변수 설정**

### 🎯 **1. 모멘텀 필터링 조건** (Day 1) - 조정범위를 slide로 처리한다.
| 변수 | 설명 | 기본값 | 조정 범위 |
|------|------|--------|-----------|
| `volume_multiplier` | 평균 거래량 대비 배수 | 2.0배 | 1.5~5.0 |
| `late_session_momentum` | 후반부(14:00~) 상승률 | 1% | 0.5~3% |
| `late_session_volume_ratio` | 후반부 거래량 비중 | 15% | 10~25% |
| `strength_threshold` | 체결강도 임계값 | 110 | 105~130 |
| `relative_return_vs_market` | 시장 대비 상대 수익률 | 1.5% | 1~3% |
| `price_vs_vwap` | VWAP 대비 종가 비율 | 102% | 101~105% |

### ⏰ **2. 시간외 진입 조건** (Day 1)
| 변수 | 설명 | 기본값 | 조정 범위 |
|------|------|--------|---------|
| `after_hours_threshold` | 시간외 매수 임계값 | 2% | 1~4% |
| `monitoring_times` | 모니터링 시점 | 16:00, 16:30, 17:00, 17:30 | 고정 |
| `monitoring_end_time` | 모니터링 종료 시간 | 17:40 | 17:20~18:00 |
| `max_positions` | 최대 동시 보유 종목 | 5개 | 3~10개 |

### 🛡️ **3. 리스크 관리** (Day 2)
| 변수 | 설명 | 기본값 | 추천 범위 |
|------|------|--------|-----------|
| `early_take_profit` | 초기 익절선 | +5% | +3~8% |
| `early_stop_loss` | 초기 손절선 | -3% | -2~5% |
| `late_take_profit` | 후기 익절선 | +3% | +2~5% |
| `final_exit_range` | 최종 청산 범위 | ±1.5% | ±1~3% |

### 🔍 **4. 기본 필터** (종목 풀) - 각 항목들은 조정가능 내에서 slide로 범위를 지정할 수 있게 한다.
| 변수 | 설명 | 기본값 | 조정 가능 |
|------|------|--------|-----------|
| `min/max_market_cap` | 시가총액 범위 | 1,000억~5조 | 자유 조정 |
| `min/max_price` | 주가 범위 | 1,000~50,000원 | 자유 조정 |
| `exclude_sectors` | 제외 업종 | 스팩, 리츠, 우선주, ETF | 추가/제거 가능 |
| `min_daily_volume` | 최소 일일 거래량 | 100억원 | 1억~500억 |

## 🔧 **동적 조건 조정 시스템**

### **조정 트리거 상황**
| 상황 | 조건 | 대응 방안 |
|------|------|-----------|
| 후보 부족 | 필터링 통과 종목 0~2개 | 조건 완화 |
| 후보 과다 | 필터링 통과 종목 20개+ | 조건 강화 |
| 시간외 미달 | 선택 종목 모두 조건 미달 | 임계값 하향 조정 |
| 기회 상실 | 연속 3일 매수 기회 없음 | 전면 조건 재검토 |

### **조정 가능 변수 범위**
| 변수 | 기본값 | 완화 범위 | 강화 범위 |
|------|--------|-----------|-----------|
| `volume_multiplier` | 2.0배 | 1.5 → 1.2 → 1.0배 | 2.5 → 3.0 → 4.0배 |
| `late_session_momentum` | 1% | 0.5 → 0 → -0.5% | 1.5 → 2.0 → 3.0% |
| `strength_threshold` | 110 | 105 → 100 → 95 | 115 → 120 → 130 |
| `relative_return_vs_market` | 1.5% | 1.0 → 0.5 → 0% | 2.0 → 2.5 → 3.0% |
| `after_hours_threshold` | 2% | 1.5 → 1.0 → 0.5% | 2.5 → 3.0 → 4.0% |

### **조정 프리셋**
#### **1단계 완화** (후보 종목 부족시)
- 거래량 배수: 2.0 → 1.5배
- 체결강도: 110 → 105
- 시간외 임계값: 2.0 → 1.5%

#### **2단계 완화** (지속적 부족시)
- 거래량 배수: 1.5 → 1.2배  
- 후반부 모멘텀: 1.0 → 0.5%
- 상대 수익률: 1.5 → 1.0%

#### **3단계 완화** (극심한 부족시)
- 거래량 배수: 1.2 → 1.0배
- 후반부 모멘텀: 0.5 → 0%
- 체결강도: 105 → 100
- 시간외 임계값: 1.5 → 1.0%

#### **조건 강화** (후보 과다시)
- 거래량 배수: 2.0 → 2.5배
- 체결강도: 110 → 115  
- 상대 수익률: 1.5 → 2.0%

### **실시간 조정 인터페이스**
```
🔧 동적 조정 화면 (15:35)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

⚠️ 현재 상황: 조건 만족 종목 0개

📊 조정 옵션:
┌─────────────────┬────────┬─────────┬─────────┐
│ 조정 항목        │ 현재값  │ 1단계    │ 2단계    │
├─────────────────┼────────┼─────────┼─────────┤
│ 거래량 배수      │ 2.0배  │ 1.5배   │ 1.2배   │
│ 체결강도        │ 110    │ 105     │ 100     │
│ 후반부 모멘텀    │ 1.0%   │ 0.5%    │ 0%      │
│ 상대 수익률      │ 1.5%   │ 1.0%    │ 0.5%    │
└─────────────────┴────────┴─────────┴─────────┘

🎯 선택 옵션:
├── [1] 1단계 완화 적용
├── [2] 2단계 완화 적용  
├── [3] 수동 조정
└── [4] 현재 조건 유지

실행 → 조정 후 즉시 재필터링
```

### **시간외 동적 조정**
```
⏰ 시간외 조정 (16:30)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 현재 상황: 선택 5종목 모두 조건 미달 (최고 상승률 1.2%)

🔧 조정 옵션:
├── 임계값 하향: 2.0% → 1.5% → 1.0%
├── 백업 종목 활용: 6~10위 종목 추가 검토
├── 새로운 필터링: 완화된 조건으로 재검색
└── 대기 지속: 다음 체크까지 현재 조건 유지

💡 권장: 임계값을 1.5%로 하향 조정
```

## 📊 **모니터링 시스템**

### **정규장 마감 후 분석 리포트 (15:35)**
```
🔍 오늘의 모멘텀 분석 결과 (2025.09.18)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📈 필터링 통과 종목: 12개
┌────────────┬────────┬─────────┬────────┬────────┐
│ 종목명      │ 점수   │ 상대수익률│ 체결강도│ 거래량배수│
├────────────┼────────┼─────────┼────────┼────────┤
│ 삼성전자    │ 95점   │ +2.1%   │ 125    │ 3.2배  │
│ SK하이닉스  │ 88점   │ +1.8%   │ 115    │ 2.8배  │
│ 네이버      │ 82점   │ +1.6%   │ 112    │ 2.1배  │
└────────────┴────────┴─────────┴────────┴────────┘

💰 시스템 권장 구성안
├── 보수적: 상위 3종목 균등 배분
├── 균형형: 상위 5종목 점수 가중 배분
└── 공격적: 상위 7종목 균등 배분

👤 사용자 결정 필요
├── 매수할 종목 선택
├── 총 투자 금액 설정  
├── 종목별 배분 비율
└── 16:00부터 시간외 자동 모니터링 시작
```

### **시간외 30분 단위 모니터링 리포트**
```
⏰ 시간외 거래 모니터링 #2 (16:30)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 선택 종목 현황
┌────────────┬─────────┬─────────┬────────┬────────┐
│ 종목명      │ 정규장종가│ 시간외가격│ 상승률  │ 매수상태│
├────────────┼─────────┼─────────┼────────┼────────┤
│ 삼성전자    │ 75,000   │ 77,200  │ +2.9%  │ ✅완료 │
│ SK하이닉스  │ 128,000  │ 130,560 │ +2.0%  │ ✅진입 │
│ 네이버      │ 180,000  │ 181,800 │ +1.0%  │ ⏸대기  │
└────────────┴─────────┴─────────┴────────┴────────┘

🎯 포지션 현황
├── 총 매수 완료: 2종목
├── 총 투자금액: 1,000만원 / 2,000만원
├── 평균 진입 프리미엄: +2.5%
└── 다음 체크: 17:00

⏭️ 설정된 금액 범위 내에서 추가 매수 기회 자동 대기

⚙️ 동적 조정 옵션 (네이버 1% < 임계값 2%)
├── 임계값 하향: 2% → 1.5% (네이버 즉시 매수 가능)
├── 백업 종목: 현대차(+1.8%) 추가 검토 가능
└── 대기 지속: 17:00까지 현재 조건 유지
```

## 🔄 **일일 운영 스케줄**

### **Day 1 (매수일)**
```
15:30-15:35  │ 장 마감 즉시 전 종목 자동 필터링
15:35        │ [필요시] 조건 조정 및 재필터링
15:35-16:00  │ 시스템 분석 리포트 확인 및 포트폴리오 구성 결정  
16:00-16:30  │ 1차 시간외 모니터링 (조건 만족시 자동 매수)
16:30        │ [필요시] 시간외 조건 조정
16:30-17:00  │ 2차 시간외 모니터링 (조건 만족시 자동 매수)  
17:00        │ [필요시] 시간외 조건 조정
17:00-17:30  │ 3차 시간외 모니터링 (조건 만족시 자동 매수)
17:30-17:40  │ 4차 최종 모니터링 (마지막 기회)
17:40-18:00  │ 포지션 정리 및 다음날 계획 수립
```

### **Day 2 (매도일)**
```
08:30-09:00  │ 장전 상황 점검 및 청산 계획 확인
09:00-13:00  │ 1차 목표가 모니터링 (+5%/-3%)
13:00-15:00  │ 2차 목표가 모니터링 (+3%/-3%)
15:00-15:20  │ 강제 청산 구간 (±1.5%)
15:20-15:30  │ 최종 무조건 청산
```

## 🎚️ **프리셋 설정**

### **보수적 설정**
- 거래량 배수: 1.5배, 체결강도: 115, 시간외: 3%
- 최대 종목: 3개, 손절: -2%, 익절: +3%

### **균형형 설정** (추천)  
- 거래량 배수: 2.0배, 체결강도: 110, 시간외: 2%
- 최대 종목: 5개, 손절: -3%, 익절: +5%

### **공격적 설정**
- 거래량 배수: 3.0배, 체결강도: 105, 시간외: 1%
- 최대 종목: 7개, 손절: -5%, 익절: +8%

## 💻 **KIS Open API 구현 체크리스트**

### **Day 1 구현 요소**
- [ ] 장 마감 후 전 종목 데이터 수집
- [ ] 필터링 조건 자동 적용 시스템
- [ ] 종목별 점수 계산 및 순위 매기기
- [ ] 동적 조건 조정 인터페이스
- [ ] 조정된 조건으로 재필터링 시스템
- [ ] 시간외 거래 실시간 모니터링
- [ ] 조건 만족시 자동 매수 주문 시스템
- [ ] 30분 단위 리포트 자동 생성
- [ ] 시간외 조건 동적 조정 기능
- [ ] 백업 종목 리스트 관리

### **Day 2 구현 요소**  
- [ ] 보유 종목 실시간 손익 계산
- [ ] 시간대별 목표가 자동 조정
- [ ] 부분 청산 및 전량 청산 로직
- [ ] 강제 청산 시스템 (지정가→시장가)
- [ ] 일일 성과 리포트 생성

## ⚠️ **운영 시 주의사항**

### **리스크 관리**
1. **자금 관리**: 총 자금의 20% 이하로 종목당 투자
2. **시장 급변**: 코스피 ±3% 이상 급변동시 전략 일시 중단  
3. **뉴스 체크**: 보유 종목 악재 발생시 즉시 청산
4. **연속 손실**: 3일 연속 손실시 1일 휴식
5. **동적 조정 남용**: 과도한 조건 완화로 인한 리스크 증가 주의
6. **조정 기록**: 매일 조정 내역 기록하여 효과성 분석

### **성과 측정 목표**
- **승률**: 65% 이상
- **평균 수익률**: +2.5% 목표
- **최대 드로우다운**: -15% 이내
- **월간 수익률**: +8~12% 목표

## 🎯 **전략의 핵심 논리**

1. **정규장 모멘텀**: 거래량과 후반부 상승세로 관심 확인
2. **시간외 검증**: 추가 상승으로 모멘텀 지속성 확인  
3. **당일 완결**: 시간 기반 청산으로 리스크 제한
4. **포트폴리오 구성**: 객관적 분석 결과를 바탕으로 사용자가 종목 선택 및 자금 배분
5. **동적 조정**: 시장 상황에 따른 실시간 조건 조정으로 기회 극대화

**이 전략은 시스템의 객관적 분석과 사용자의 포트폴리오 구성 결정을 결합한 방식으로, 매수 시점과 매도 시점은 완전 자동화되어 감정적 개입을 차단하며, 동적 조정 시스템으로 다양한 시장 환경에서도 안정적인 기회 포착이 가능합니다.**